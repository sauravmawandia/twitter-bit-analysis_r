title: "Project"
author: "Saurav"
date: "3/23/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Reading the data from The CSV files¶

```{r setup}

twitterBots <- read.csv("/Users/saurav/git/data/bots_data.csv", comment.char="#")
twitterNonBots <- read.csv("/Users/saurav/git/data/nonbots_data.csv", comment.char="#")
user <- read.csv("/Users/saurav/git/data/training_data_2_csv_UTF.csv", comment.char="#")
test <- read.csv("/Users/saurav/git/data/test_data_4_students.csv", comment.char="#")

```

## Cleaning Training Data and converting it to boolean & numeric values


```{r cleaing}
library(stringr)
df=user
df$favourites_count[df$favourites_count =='None'] <- 0
df$favourites_count[is.na(df$favourites_count)] <- 0


df$name[str_detect(df$name,'bot')] <- FALSE
df$name[is.na(df$name)] <- ''

df$bot[str_detect(df$bot,'bot')] <- FALSE
df$bot[is.na(df$bot)] <- FALSE

df$statuses_count[df$statuses_count=='NONE'] <- 0
df$statuses_count[df$statuses_count==''] <- 0
df$statuses_count[is.na(df$statuses_count)] <-0

df$followers_count[is.na(df$followers_count)] <-0

df$friends_count <- as.integer(df$friends_count)
df$friends_count[is.na(df$friends_count)] <- 0

df$verified[df$verified==''] <- FALSE
df$verified[df$verified=='TRUE'] <- TRUE
df$verified[df$verified=='FALSE'] <- FALSE

df$favourites_count[df$favourites_count =='None'] <- 0

df$favourites_count <-as.integer(df$favourites_count)
df$favourites_count[is.na(df$favourites_count)] <- 0

df$default_profile[df$default_profile =='None'] <- FALSE
df$default_profile[df$default_profile ==''] <- FALSE
df$default_profile[df$default_profile =='FALSE'] <- FALSE
df$default_profile[df$default_profile =='False'] <- FALSE
df$default_profile[df$default_profile =='TRUE'] <- TRUE
df$default_profile[df$default_profile =='True'] <- TRUE
df$default_profile[is.na(df$default_profile)] <- FALSE

df$default_profile_image[df$default_profile_image =='None'] <- FALSE
df$default_profile_image[df$default_profile_image ==''] <- FALSE
df$default_profile_image[is.na(df$default_profile_image)] <- FALSE
df$default_profile_image[df$default_profile_image =='True'] <- TRUE
df$default_profile_image[df$default_profile_image =='False'] <- FALSE

df$name[is.na(df$name)] <- ''
df$name[str_detect(df$name,regex('bot',ignore_case = T))] <- FALSE
df$name[df$name==""] <- FALSE
df$name[df$name!="FALSE"] <- TRUE


df$screen_name[is.na(df$screen_name)] <- ''
df$screen_name[str_detect(df$screen_name,regex('bot',ignore_case = T))] <- FALSE
df$screen_name[df$screen_name==""] <- FALSE
df$screen_name[df$screen_name!="FALSE"] <- TRUE

df$description[is.na(df$description)] <- ''
df$description[str_detect(df$description,regex('bot',ignore_case = T))] <- FALSE
df$description[df$description==""] <- FALSE
df$description[df$description!="FALSE"] <- TRUE


library(lubridate)
df$created_at[is.na(df$created_at)] <- '2021-03-29 02:52:00'
df$created_at[df$created_at ==''] <- '2021-03-29 02:52:00'
df$created_at <-  gsub("\\+00:00", "", df$created_at)
df$created_at=parse_date_time(df$created_at, orders = "ymd_HMS")
```
##Calculating the status per day from the day account was created

```{r check status}

df$today <- Sys.Date()
df$created_at<-strptime(df$created_at, format = "%Y-%m-%d")
df$daysTillNow <- as.numeric(difftime(df$today, df$created_at, units = "days"))
df$statusPerDay <- as.numeric(df$statuses_count)/df$daysTillNow
df$statusPerDay <-round(df$statusPerDay)

```

Cleaning Test data and doing the same work we did for Training data¶

```{r clean test data}
tf=test

tf$favourites_count[tf$favourites_count =='None'] <- 0
tf$favourites_count[is.na(tf$favourites_count)] <- 0

tf$favourites_count <-as.integer(tf$favourites_count)


tf$default_profile[tf$default_profile =='None'] <- FALSE
tf$default_profile[tf$default_profile ==''] <- FALSE
tf$default_profile[tf$default_profile =='FALSE'] <- FALSE
tf$default_profile[tf$default_profile =='False'] <- FALSE
tf$default_profile[tf$default_profile =='TRUE'] <- TRUE
tf$default_profile[tf$default_profile =='True'] <- TRUE
tf$default_profile[is.na(tf$default_profile)] <- FALSE

tf$default_profile_image[tf$default_profile_image =='None'] <- FALSE
tf$default_profile_image[tf$default_profile_image ==''] <- FALSE
tf$default_profile_image[is.na(tf$default_profile_image)] <- FALSE
tf$default_profile_image[tf$default_profile_image =='True'] <- TRUE
tf$default_profile_image[tf$default_profile_image =='False'] <- FALSE

tf$name[is.na(tf$name)] <- ''
tf$name[str_detect(tf$name,regex('bot',ignore_case = T))] <- FALSE
tf$name[tf$name==""] <- FALSE
tf$name[tf$name!="FALSE"] <- TRUE


tf$screen_name[is.na(tf$screen_name)] <- ''
tf$screen_name[str_detect(tf$screen_name,regex('bot',ignore_case = T))] <- FALSE
tf$screen_name[tf$screen_name==""] <- FALSE
tf$screen_name[tf$screen_name!="FALSE"] <- TRUE

tf$description[is.na(tf$description)] <- ''
tf$description[str_detect(tf$description,regex('bot',ignore_case = T))] <- FALSE
tf$description[tf$description==""] <- FALSE
tf$description[tf$description!="FALSE"] <- TRUE

tf$statuses_count[tf$statuses_count=='NONE'] <- 0
tf$statuses_count[tf$statuses_count==''] <- 0
tf$statuses_count[is.na(tf$statuses_count)] <-0

tf$followers_count[is.na(tf$followers_count)] <-0

tf$friends_count <- as.integer(tf$friends_count)
tf$friends_count[is.na(tf$friends_count)] <- 0

tf$verified[tf$verified==''] <- FALSE
tf$verified[tf$verified=='TRUE'] <- TRUE
tf$verified[tf$verified=='FALSE'] <- FALSE



tf$screen_name[str_detect(tf$screen_name,'bot')] <- FALSE
tf$screen_name[is.na(tf$screen_name)] <- FALSE


tf$name[str_detect(tf$name,'bot')] <- FALSE
tf$name[is.na(tf$name)] <- ''

tf$description[str_detect(tf$description,'bot')] <- FALSE

tf$created_at[is.na(tf$created_at)] <- '2021-03-29 02:52:00'
tf$created_at[tf$created_at ==''] <- '2021-03-29 02:52:00'
tf$created_at <-  gsub("\\+00:00", "", tf$created_at)
tf$created_at=parse_date_time(tf$created_at, orders = "ymd_HMS")

tf$today <- Sys.Date()
tf$created_at<-strptime(tf$created_at, format = "%Y-%m-%d")
tf$daysTillNow <- as.numeric(difftime(tf$today, tf$created_at, units = "days"))
tf$statusPerDay <- as.numeric(tf$statuses_count)/tf$daysTillNow
tf$statusPerDay[is.na(tf$statusPerDay)] <- 0




```

  


##Splitting the data

```{r splitting the data }
#install.packages('caTools')
library(caTools)
#We Split the sample data in the ratio of 70:30

split = sample.split(df$bot,
                      SplitRatio = .70)

#70% of sample data includes the training set and rest 30% is test set
training_set = subset(df, split == TRUE)
test_set = subset(df, split == FALSE)
```




##Fitting the training data and predicting test data contained in training data and the test data from using logistic regression
```{r fitting model}

##mylogit <- glm(bot ~ friends_count + followers_count + statusPerDay + verified + favourites_count  + description
 ##              + default_profile_image + default_profile + screen_name + name, data = training_set, family = "binomial")

logit_twitter <- glm(bot ~  friends_count+ followers_count + statusPerDay + verified + favourites_count + name + screen_name + description, data = training_set, family = "binomial")
summary(logit_twitter)

confint(logit_twitter)
install.packages("aod")
library("aod")
wald.test(b = coef(logit_twitter), Sigma = vcov(logit_twitter), Terms = 4:6)


exp(coef(logit_twitter))

exp(cbind(OR = coef(logit_twitter), confint(logit_twitter)))


```

